Search.setIndex({"docnames": ["Examples/Horizontal/Sim_Horizon", "Examples/Mosaic/SpaMode_Mosaic_HT", "Examples/Vertical/RNA-ADT/SpaMode_HLN_A1", "Examples/Vertical/RNA-ATAC/SpaMode_MISAR_E13", "index"], "filenames": ["Examples/Horizontal/Sim_Horizon.ipynb", "Examples/Mosaic/SpaMode_Mosaic_HT.ipynb", "Examples/Vertical/RNA-ADT/SpaMode_HLN_A1.ipynb", "Examples/Vertical/RNA-ATAC/SpaMode_MISAR_E13.ipynb", "index.rst"], "titles": ["Horizontal integration (Simulation)", "Mosaic Integration (HT)", "RNA-ADT Vertical Integration (HLN)", "RNA-ATAC Vertical Integration (Mouse Embryo E11.0)", "Welcome to SpaMode's documentation!"], "terms": {"horizont": 4, "integr": 4, "simul": 4, "1": [0, 1, 2, 3], "import": [0, 1, 2, 3], "o": [0, 1, 2, 3], "torch": [0, 1, 2, 3], "panda": [0, 1, 2, 3], "pd": [0, 1, 2, 3], "scanpi": [0, 1, 2, 3], "sc": [0, 1, 2, 3], "numpi": [0, 1, 2, 3], "np": [0, 1, 2, 3], "copi": [0, 1, 2, 3], "scipi": [0, 1, 2, 3], "anndata": [0, 1, 2, 3], "ad": [0, 1], "from": [0, 1, 2, 3], "spamod": [0, 1, 2, 3], "preprocess": [0, 1, 2, 3], "clr_normalize_each_cel": [0, 1, 2, 3], "pca": [0, 1, 2, 3], "lsi": [0, 1], "construct_neighbor_graph": [0, 1], "process_bc_list": 0, "data_preprocess": [0, 1], "combine_bc": 0, "process_spatial_adj": 0, "get_feat_adj": 0, "util": [0, 1, 2, 3], "cluster": [0, 1, 2, 3], "peak_sets_align": [0, 1], "gene_sets_align": [0, 1], "cal_matr": [0, 1, 2, 3], "eval": [0, 1, 2, 3], "spars": [0, 1, 2, 3], "coo_matrix": [0, 1, 3], "sklearn": [0, 1, 3], "neighbor": [0, 1], "kneighbors_graph": [0, 1], "csr_matrix": [0, 1], "isspars": [0, 1, 3], "fix": [0, 1], "random": [0, 1], "seed": [0, 1], "sme": [0, 1], "fix_se": [0, 1, 2, 3], "random_se": [0, 1], "2024": [0, 2, 3], "process": [0, 1], "batch": 0, "data": [0, 1, 2, 3], "2": [0, 1, 2, 3], "base_path": 0, "home": [0, 2, 3], "hxl": [0, 2, 3], "spa_multi": [0, 2, 3], "omic": [0, 2, 3], "gen_sim": 0, "multiome_zinb_nb_sim_bc": 0, "file_path": [0, 1], "slice": [0, 1], "rna": [0, 1, 4], "h5ad": [0, 1, 3], "protein": [0, 1], "3": [0, 1, 2, 3], "load": [0, 1, 2, 3], "all": [0, 1], "object": [0, 1, 2, 3], "adata_omics1_list": 0, "adata_omics2_list": 0, "path": 0, "valu": [0, 2], "adata_omics1": [0, 1, 2, 3], "adata_omics2": [0, 1, 2], "read_h5ad": [0, 1, 2, 3], "fp": [0, 1], "append": [0, 1, 2, 3], "align": 0, "gene": 0, "peak": [0, 3], "set": 0, "adata_omics1_norm_list": 0, "adata_omics2_norm_list": 0, "adata1": 0, "adata2": 0, "zip": 0, "creat": 0, "sourc": 0, "adata_omics1_src": 0, "deepcopi": [0, 1], "adata_omics2_src": 0, "normal": [0, 1], "adata_omics1_norm": 0, "adata_omics2_norm": 0, "combin": 0, "across": 0, "src_adata_omics1": 0, "src_adata_omics2": 0, "src_adata_omics1_bc": 0, "src_adata_omics2_bc": 0, "construct": [0, 1, 2, 3], "graph": [0, 2, 3], "each": 0, "adata_list": 0, "norm_adata1": 0, "norm_adata2": 0, "datatyp": [0, 1, 2, 3], "sim_l": 0, "spatial_adj_pd": 0, "adata": [0, 1, 2, 3], "un": [0, 1, 2, 3], "adj_spati": 0, "initi": 0, "norm_feat": 0, "total_ob": 0, "n_ob": [0, 1, 2, 3], "obsm": [0, 1, 2, 3], "zero": [0, 1], "0": [0, 1, 2, 4], "feat": [0, 1, 2, 3], "shape": [0, 1, 2, 3], "fill": 0, "featur": [0, 3], "start_idx": 0, "end_idx": 0, "adata_omics1_adj_feature_spars": 0, "adata_omics2_adj_feature_spars": 0, "norm_adj_featur": 0, "save": 0, "bc": 0, "write_h5ad": [0, 1], "sim_bc": 0, "format": 0, "adata_rna_be_pca": 0, "adata_protein_be_pca": 0, "anaconda": [0, 2, 3], "enter": [0, 2, 3], "env": [0, 2, 3], "torch21_py38": [0, 2, 3], "lib": [0, 2, 3], "python3": [0, 2, 3], "8": [0, 1, 2, 3], "site": [0, 2, 3], "packag": [0, 2, 3], "_normal": 0, "py": [0, 1, 2, 3], "196": 0, "userwarn": [0, 1, 2, 3], "some": 0, "cell": [0, 1, 3], "have": 0, "count": 0, "warn": [0, 1], "39": [0, 1, 2, 3], "n_var": [0, 1, 2, 3], "1296": 0, "600": 0, "var": [0, 1, 2, 3], "highly_vari": [0, 1, 2, 3], "highly_variable_rank": [0, 1, 2, 3], "mean": [0, 1, 2, 3], "varianc": [0, 1, 2, 3], "variances_norm": [0, 1, 2, 3], "std": [0, 1, 2, 3], "modal": 0, "hvg": [0, 1, 2, 3], "log1p": [0, 1, 2, 3], "nsfac": 0, "spatial": [0, 1, 2, 3], "spfac": 0, "varm": 0, "nsload": 0, "spload": 0, "layer": 0, "350": 0, "unit": 0, "3888": 0, "ob": [0, 1, 2, 3], "spatial_neighbor": [0, 1, 2, 3], "4": [0, 1, 2, 3], "feature_neighbor": [0, 1, 2, 3], "20": [0, 1, 2, 3], "train": [0, 1, 2, 3], "config": [0, 1, 2, 3], "devic": [0, 1, 2, 3], "cuda": [0, 1, 2, 3], "is_avail": [0, 1, 2, 3], "els": [0, 1, 2, 3], "cpu": [0, 1, 2, 3], "atac": [0, 4], "0222": [0, 1], "sim_0611": 0, "print": [0, 1, 2, 3], "adj_featur": 0, "json": [0, 1, 2, 3], "\u52a0\u8f7d\u914d\u7f6e\u6587\u4ef6": [0, 1], "open": [0, 1, 2, 3], "cfg_sim": 0, "r": [0, 1, 2, 3], "file": [0, 1, 2, 3], "spamode_multi_0318": 0, "train_spamod": [0, 1, 2, 3], "model": [0, 1, 2, 3], "train_smo": [0, 1], "misar": [0, 3], "arg": [0, 1, 2, 3], "adt": [0, 1, 4], "multi": 0, "output": [0, 1, 2, 3], "205": [0, 2], "sparsetensor": [0, 2], "indic": [0, 1, 2], "i": [0, 1, 2], "deprec": [0, 1, 2, 3], "pleas": [0, 2], "us": [0, 1, 2], "sparse_coo_tensor": [0, 2], "dtype": [0, 2], "trigger": [0, 2], "intern": [0, 2], "csrc": [0, 2], "tensor_new": [0, 2], "cpp": [0, 2], "605": [0, 2], "return": [0, 1, 2, 3], "floattensor": [0, 2], "svae_multi_0318": 0, "309": 0, "implicit": [0, 1, 2, 3], "dimens": [0, 1, 2, 3], "choic": [0, 1, 2, 3], "softmax": [0, 1, 2, 3], "ha": [0, 1, 2, 3], "been": [0, 1, 2, 3], "chang": [0, 1, 2, 3], "call": [0, 1, 2, 3], "includ": [0, 1, 2, 3], "dim": [0, 1, 2, 3], "x": [0, 1, 2, 3], "an": [0, 1, 2, 3], "argument": [0, 1, 2, 3], "weight": [0, 1, 2, 3], "f": [0, 1, 2, 3], "differ_stack": [0, 1, 2, 3], "optim": [0, 1, 2, 3], "adamw": [0, 2], "198": 0, "1000": [0, 1, 2, 3], "00": [0, 2, 3], "11": 0, "lt": [0, 1, 2, 3], "46": 0, "17": [0, 2, 3], "09it": 0, "": [0, 1, 2, 3], "loss_ori": 0, "9": [0, 2], "83": 0, "earli": [0, 1, 2, 3], "stop": [0, 1, 2, 3], "finish": [0, 1, 2, 3], "umap": 0, "def": [0, 1, 3], "read_list_from_fil": 0, "list": 0, "line": 0, "num": [0, 2, 3], "int": 0, "strip": 0, "feat_a1": 0, "smoe": [0, 1], "feat_a2": 0, "2592": 0, "feat_a3": 0, "vstack": 0, "adata_combin": 0, "tool": [0, 2, 3], "mclust": [0, 2, 3], "leiden": [0, 2, 3], "louvain": [0, 2, 3], "kei": [0, 2, 3], "add_kei": [0, 2, 3], "n_cluster": [0, 2, 3], "5": [0, 1, 2, 3], "method": [0, 2, 3], "use_pca": [0, 2, 3], "true": [0, 1, 2, 3], "label": [0, 3], "tolist": [0, 2, 3], "arrai": [0, 1, 2, 3], "astyp": [0, 1, 2, 3], "str": [0, 2, 3], "categori": [0, 2, 3], "output_fil": 0, "_output_path": 0, "_cluster": 0, "txt": [0, 1, 2, 3], "w": [0, 2, 3], "write": [0, 2, 3], "n": [0, 1, 2, 3], "labels_a1": 0, "gt": [0, 1], "labels_a2": 0, "labels_a3": 0, "concaten": [0, 1], "smoe_df": 0, "_1_2_3": 0, "cls_label": 0, "pp": [0, 1, 2, 3], "n_neighbor": [0, 1, 3], "use_rep": 0, "tl": 0, "pl": [0, 2, 3], "color": [0, 2, 3], "titl": [0, 2, 3], "dataset": [0, 3], "legend_loc": 0, "repeat": 0, "bc_label": 0, "\u7ed8\u5236": 0, "\u56fe": 0, "section": 0, "fit": [0, 1, 2, 3], "100": [0, 1, 2, 3], "plot": [0, 2, 3], "_tool": [0, 2, 3], "scatterplot": [0, 2, 3], "394": [0, 2, 3], "No": [0, 2, 3], "colormap": [0, 2, 3], "provid": [0, 2, 3], "via": [0, 2, 3], "c": [0, 2, 3], "paramet": [0, 2, 3], "cmap": [0, 2, 3], "ignor": [0, 2, 3], "cax": [0, 2, 3], "scatter": [0, 2, 3], "mosaic": 4, "ht": 4, "argpars": [1, 2, 3], "type": [1, 2], "option": 1, "combat": 1, "svae": 1, "nn": 1, "function": 1, "nearestneighbor": 1, "decomposit": 1, "csgraph": 1, "laplacian": 1, "procrust": 1, "metric": [1, 2, 3], "pairwis": 1, "cosine_similar": 1, "sp": 1, "adjusted_rand_scor": 1, "roc_auc_scor": 1, "f1_score": 1, "environ": 1, "configur": 1, "spatialglu": 1, "pacakg": 1, "can": 1, "implement": 1, "either": 1, "gpu": 1, "acceler": 1, "highli": 1, "recommend": 1, "imporov": 1, "effici": 1, "binar": 1, "bin_thr": 1, "A": 1, "where": 1, "eval_auc_al": 1, "gt_x": 1, "pr_x": 1, "flatten": 1, "auroc": 1, "pcc": 1, "_compute_pcc": 1, "y": 1, "axi": [1, 3], "x_center": 1, "keepdim": 1, "y_center": 1, "cov": 1, "sum": [1, 3], "std_x": 1, "sqrt": 1, "std_y": 1, "denom": 1, "nan": 1, "pcc_cell": 1, "cmd": 1, "zero_mask": 1, "ani": 1, "rm_p": 1, "05": 1, "too": 1, "mani": 1, "row": 1, "1f": 1, "pr_arrai": 1, "float32": 1, "gt_arrai": 1, "fast_corr": 1, "t": [1, 3], "corr_pr": 1, "corr_gt": 1, "1e": [1, 3], "reconstruct_missing_mod": 1, "existing_m1_emb": 1, "ref_m1_emb": 1, "existing_m2": 1, "a1": [1, 2], "a2": 1, "recon_s2_m2": 1, "none": 1, "imput_pca": 1, "fals": [1, 2, 3], "aggregate_neighborhood_featur": 1, "algorithm": 1, "brute": 1, "euclidean": 1, "_": [1, 2], "kneighbor": 1, "ravel": 1, "imput_m2": 1, "imput_m1": 1, "erro": 1, "tensor": [1, 2, 3], "unsqueez": 1, "imput": 1, "p": 1, "ep": 1, "12": 1, "k": 1, "25": 1, "indices_flat": 1, "toarrai": [1, 3], "reshap": [1, 3], "b": 1, "d": 1, "a_norm": 1, "linalg": 1, "norm": [1, 3], "b_norm": 1, "aggreg": 1, "r_agg": 1, "a_spars": 1, "detach": 1, "rang": 1, "elif": [1, 3], "concat": 1, "30": [1, 2, 3], "var_names_make_uniqu": [1, 2, 3], "highly_variable_gen": [1, 2, 3], "flavor": [1, 2, 3], "seurat_v3": [1, 2, 3], "n_top_gen": [1, 2, 3], "3000": [1, 2, 3], "normalize_tot": [1, 2, 3], "target_sum": [1, 2, 3], "1e4": [1, 2, 3], "scale": [1, 2, 3], "max_valu": 1, "adata_omics1_high": [1, 2, 3], "n_comp": [1, 2, 3], "2025": 1, "root": 1, "autodl": 1, "tmp": 1, "human_tonsil": 1, "slice1": 1, "s1_adata_rna": 1, "s1_adata_adt": 1, "slice2": 1, "s2_adata_rna": 1, "s2_adata_adt": 1, "slice3": 1, "s3_adata_rna": 1, "s3_adata_adt": 1, "gt_path": [1, 2, 3], "result": [1, 2, 3], "adata_omics1_cp": 1, "adata_omics2_cp": 1, "10x": [1, 2], "cfg_train": [1, 2, 3], "spamode_mosa": 1, "s2_adt": 1, "adata_omics1_e15": 1, "adata_omics2_e15": 1, "adata_omics2_e15_cp": 1, "adata_e15": 1, "infer_result": 1, "imput_adt_pca": 1, "adata_omics1_spatial_smooth": 1, "adata_omics1_e15_spatial_smooth": 1, "adj_spatial_omics1": 1, "tmp_adj_spatial_omics1": 1, "emb_recon_omics2": 1, "adata_e15_imput": 1, "model_mosa": 1, "our": [1, 2, 3], "slice_2": 1, "4326": 1, "18085": 1, "lab": 1, "lab_lynn": 1, "src": 1, "final_annot": 1, "gene_id": [1, 2, 3], "feature_typ": [1, 2, 3], "genom": [1, 2, 3], "31": [1, 2, 3], "spamode_0903": 1, "svae_0318": 1, "104": 1, "8057": 1, "5797": 1, "5563": 1, "4437": 1, "sgd": [1, 3], "51": 1, "509": 1, "01": [1, 2], "55": 1, "41it": 1, "biloss": [1, 2, 3], "191": 1, "adv_loss": [1, 2, 3], "271": 1, "kl_loss": [1, 2, 3], "897": 1, "moe_loss": [1, 2, 3], "0202": 1, "recon": [1, 2, 3], "18": 1, "6": [1, 2, 3], "4519": 1, "296": 1, "0000": 1, "5000": 1, "size": 1, "64": 1, "ipykernel_7187": 1, "2397127696": 1, "84": 1, "To": [1, 2, 3], "sourcetensor": 1, "clone": 1, "requires_grad_": 1, "rather": 1, "than": 1, "7120": 1, "8796": 1, "4582": 1, "5418": 1, "549": 1, "02": 1, "21": 1, "56": 1, "87it": 1, "166": 1, "245": 1, "864": 1, "00209": 1, "mix_omics1": 1, "mix_omics2": 1, "imput_adt_raw": 1, "adata_omics2_e15_imput": 1, "ht_s2_adt_imput_our": 1, "pcc_adt": 1, "cmd_cell": 1, "cmd_adt": 1, "command": 1, "93754214": 1, "010368214880204674": 1, "22684393721285268": 1, "vertic": 4, "hln": 4, "matplotlib": [2, 3], "pyplot": [2, 3], "plt": [2, 3], "cfg": [2, 3], "adata_omics_list": [2, 3], "rna_path": [2, 3], "filter_gen": [2, 3], "min_cel": [2, 3], "10": [2, 3], "adt_path": [2, 3], "_core": [2, 3], "1840": [2, 3], "variabl": [2, 3], "name": [2, 3], "ar": [2, 3], "uniqu": [2, 3], "make": [2, 3], "them": [2, 3], "warn_names_dupl": [2, 3], "34": [2, 3], "3484": 2, "17954": 2, "n_cell": [2, 3], "construct_neighbor_graph_spamod": [2, 3], "defin": [2, 3], "4940": 2, "5060": 2, "285": [2, 3], "74": 2, "741": 2, "28": [2, 3], "36it": 2, "68": 2, "238": 2, "673": 2, "00661": 2, "label_list": [2, 3], "our_label": [2, 3], "consol": 2, "__": 2, "____": 2, "___": 2, "_____": 2, "_______": 2, "version": 2, "citat": 2, "cite": 2, "thi": 2, "public": 2, "visual": [2, 3], "7": [2, 3], "fig": [2, 3], "embed": [2, 3], "basi": [2, 3], "120": 2, "show": [2, 3], "return_fig": [2, 3], "ax": [2, 3], "set_xlabel": [2, 3], "set_ylabel": [2, 3], "tight_layout": [2, 3], "w_pad": [2, 3], "txt_out_path": [2, 3], "spamode_a1": 2, "eval_save_path": [2, 3], "spamode_a1_metr": 2, "jaccard": [2, 3], "316279": 2, "f_measur": [2, 3], "480566": 2, "mutual": [2, 3], "inform": [2, 3], "730142": 2, "nmi": [2, 3], "407188": 2, "ami": [2, 3], "403157": 2, "v": [2, 3], "measur": [2, 3], "homogen": [2, 3], "432804": 2, "complet": [2, 3], "384435": 2, "ari": [2, 3], "342526": 2, "fmi": [2, 3], "482081": 2, "mous": 4, "embryo": 4, "e11": 4, "24": 3, "e11_0": 3, "s1": 3, "misar_e11_0": 3, "s1_rna": 3, "atac_path": 3, "s1_atac": 3, "misar_combined_e11_0_s1_gt": 3, "training_epoch": 3, "learning_r": 3, "0005": 3, "weight_decai": 3, "weight_recon": 3, "weight_bi": 3, "weight_adv": 3, "weight_kl": 3, "06": 3, "weight_mo": 3, "earlystop": 3, "early_stop_pati": 3, "27": 3, "tfidf": 3, "count_mat": 3, "type_": 3, "perform": 3, "tf": 3, "idf": 3, "tfidf1": 3, "nfreq": 3, "multipli": 3, "tfidf_mat": 3, "log": 3, "tocoo": 3, "signac": 3, "default": 3, "select": 3, "tfidf2": 3, "tf_mat": 3, "signac_mat": 3, "feature_extract": 3, "text": 3, "tfidftransform": 3, "tfidf3": 3, "smooth_idf": 3, "l2": 3, "transpos": 3, "idf_": 3, "tf_idf": 3, "transform": 3, "adata_omics3": 3, "obs_nam": 3, "x_lsi": 3, "repres": 3, "reduc": 3, "50": 3, "1263": 3, "15537": 3, "atac_clust": 3, "combined_clust": 3, "rna_clust": 3, "69370": 3, "29": 3, "4570": 3, "5430": 3, "32": 3, "325": 3, "08": 3, "38": 3, "16it": 3, "248": 3, "282": 3, "254": 3, "0328": 3, "35": 3, "200": 3, "sr": 3, "33": 3, "spatial_rectifi": 3, "label_smooth": 3, "label_list_sr": 3, "threshold": 3, "correct": 3, "total": 3, "54": 3, "14": 3, "spamode_e15_5": 3, "spamode_e15_5_metr": 3, "598982": 3, "749204": 3, "826842": 3, "607462": 3, "604966": 3, "570163": 3, "649983": 3, "646928": 3, "750140": 3, "index": [], "modul": [], "search": [], "page": []}, "objects": {}, "objtypes": {}, "objnames": {}, "titleterms": {"welcom": 4, "spamod": 4, "": 4, "document": 4, "indic": [], "tabl": [], "horizont": 0, "integr": [0, 1, 2, 3], "simul": 0, "mosaic": 1, "ht": 1, "rna": [2, 3], "adt": 2, "vertic": [2, 3], "hln": 2, "atac": 3, "mous": 3, "embryo": 3, "e11": 3, "0": 3, "exampl": 4}, "envversion": {"sphinx.domains.c": 3, "sphinx.domains.changeset": 1, "sphinx.domains.citation": 1, "sphinx.domains.cpp": 9, "sphinx.domains.index": 1, "sphinx.domains.javascript": 3, "sphinx.domains.math": 2, "sphinx.domains.python": 4, "sphinx.domains.rst": 2, "sphinx.domains.std": 2, "nbsphinx": 4, "sphinx": 58}, "alltitles": {"Horizontal integration (Simulation)": [[0, "Horizontal-integration-(Simulation)"]], "Mosaic Integration (HT)": [[1, "Mosaic-Integration-(HT)"]], "RNA-ADT Vertical Integration (HLN)": [[2, "RNA-ADT-Vertical-Integration-(HLN)"]], "RNA-ATAC Vertical Integration (Mouse Embryo E11.0)": [[3, "RNA-ATAC-Vertical-Integration-(Mouse-Embryo-E11.0)"]], "Welcome to SpaMode's documentation!": [[4, "welcome-to-spamode-s-documentation"]], "Examples": [[4, null]]}, "indexentries": {}})